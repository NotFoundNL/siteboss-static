(window.webpackJsonp=window.webpackJsonp||[]).push([[65,8],{713:function(e,t,r){"use strict";var n=r(20),o=r(720),l=r(84),c=r(108),d=r(124),f=r(241);n({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,t=l(this),r=c(t),n=f(t,0);return n.length=o(n,t,t,r,0,void 0===e?1:d(e)),n}})},714:function(e,t,r){r(176)("flat")},715:function(e,t,r){e.exports={}},716:function(e,t,r){e.exports={}},717:function(e,t,r){"use strict";r.r(t);r(33),r(17),r(16),r(13),r(18),r(19);var n=r(2),o=(r(238),r(10),r(14),r(43),r(713),r(714),r(542)),l=r.n(o);function c(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function d(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var f={components:{DraggableField:r(725).default,draggable:l.a},props:{list:{required:!0,type:Array,default:null},multiPage:{type:Boolean,required:!1,default:!1},givenParentId:{required:!1,type:Number}},computed:{mobileView:function(){return this.$store.state.formbuilder.mobileView},groupOptions:function(){return this.multiPage?{name:"formbuilder",pull:!1,put:!1}:{name:"formbuilder",pull:!0,put:!0}},activeField:{get:function(){return this.$store.state.formbuilder.activeField},set:function(e){return this.$store.commit("formbuilder/setActiveField",JSON.parse(JSON.stringify(e)))}},temporaryId:{get:function(){return this.$store.state.formbuilder.activeForm.temporaryId}},fields:{get:function(){return this.$store.state.formbuilder.fields},set:function(e){return this.$store.commit("formbuilder/setFields",e)}}},methods:{resetFieldIds:function(e){var t=this;return e.id=null,e.temporaryId=this.temporaryId,e.fields&&e.fields.forEach((function(r){r.parent_id=e.temporaryId,t.resetFieldIds(r)})),this.$store.commit("formbuilder/incrementTemporaryId"),e},onChange:function(e){var t=this,r=e.added;if(r){var n,o=this.list[r.newIndex];if(o.combinationId)this.$axios.get("/forms/".concat(o.combinationId,"/fields/")).then((function(e){var n;o.fields=e.data.fields.map((function(e){return t.resetFieldIds(e)})),delete o.combinationId,t.activeField=d(d({},o),{},{currentIndex:r.newIndex,parent_id:null!==(n=t.givenParentId)&&void 0!==n?n:o.parent_id,new:!0})})).catch((function(e){t.$sbToast.error("Error loading combination fields")}));else this.activeField=d(d({},o),{},{currentIndex:r.newIndex,parent_id:null!==(n=this.givenParentId)&&void 0!==n?n:o.parent_id,new:!0})}},onClone:function(e){var t,r=this.resetFieldIds(JSON.parse(JSON.stringify(this.list[e]))),n=this.list.map((function(t,n){return n===e?[t,r]:t})).flat(),o=!1;this.fields=r.parent_id?this.fields.map((function(e){if(!o){return e=function e(t){return!o&&(t.id&&t.id===r.parent_id||!t.id&&t.temporaryId&&t.temporaryId===r.parent_id)?(o=!0,t.fields=n):!o&&t.fields&&(t.fields=t.fields.map((function(t){return e(t)}))),t}(e),e}return e})):n,this.activeField=d(d({},r),{},{currentIndex:e+1,new:!0,parent_id:null!==(t=this.givenParentId)&&void 0!==t?t:r.parent_id})},widthCol:function(e){if(this.mobileView){if(e.properties&&e.properties.mobilewidth)return"col-sm-".concat(e.properties.mobilewidth)}else if(e.properties&&e.properties.width)return"col-sm-".concat(e.properties.width);return"col-sm-12"}}},m=(r(724),r(63)),component=Object(m.a)(f,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"mx-3"},[t("draggable",{class:{"all-fields-container row":!0,border:0===e.list.length},attrs:{list:e.list,group:e.groupOptions,forceFallback:!0,sort:!0,handle:".card-draggable-anchor","ghost-class":"sortable-ghost",direction:"vertical"},on:{change:e.onChange}},e._l(e.list,(function(r,n){return t("draggable-field",{key:"".concat(r.id,"-").concat(r.temporaryId,"-").concat(n),staticClass:"card fielditem",class:e.widthCol(r),attrs:{givenParentId:e.givenParentId,field:r,index:n},on:{clone:e.onClone}})})),1)],1)}),[],!1,null,"558ea0bd",null);t.default=component.exports},720:function(e,t,r){"use strict";var n=r(179),o=r(108),l=r(289),c=r(71),d=function(e,t,source,r,f,m,v,h){for(var element,y,O=f,w=0,_=!!v&&c(v,h);w<r;)w in source&&(element=_?_(source[w],w,t):source[w],m>0&&n(element)?(y=o(element),O=d(e,t,element,y,O,m-1)-1):(l(O+1),e[O]=element),O++),w++;return O};e.exports=d},723:function(e,t,r){"use strict";r(715)},724:function(e,t,r){"use strict";r(716)},725:function(e,t,r){"use strict";r.r(t);var n=r(2);r(10),r(66),r(68),r(238),r(147),r(50),r(43),r(91),r(114),r(14),r(17),r(16),r(13),r(18),r(19);function o(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function l(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?o(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):o(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var c={components:{FormbuilderFieldList:function(){return Promise.resolve().then(r.bind(null,717))}},props:{field:{type:Object,required:!0},index:{type:Number,required:!0},givenParentId:{type:Number,required:!1}},data:function(){return{ishovering:!1,collapsed:!1}},computed:{combination:function(){return"combination"===this.field.type.toLowerCase()},guaranteedParentId:function(){var e,t;return null!==(e=null===(t=this.field)||void 0===t?void 0:t.id)&&void 0!==e?e:this.field.temporaryId},title:function(){var e;return this.getAvailableLanguage(null===(e=this.field.properties)||void 0===e?void 0:e.label)},typename:function(){var e=this,t=this.$store.state.formbuilder.fieldProperties.find((function(t){return e.field.type===t.type}));return t?t.name:""},activeField:{get:function(){return this.$store.state.formbuilder.activeField},set:function(e){return this.$store.commit("formbuilder/setActiveField",JSON.parse(JSON.stringify(e)))}}},methods:{getAvailableLanguage:function(object){var e="--",t=this.$store.state.formbuilder.activeForm.locales.length>0?this.$store.state.formbuilder.activeForm.locales:this.$store.state.locales.list.map((function(e){return e.url}));return t.includes(this.$store.state.locales.default)&&object[this.$store.state.locales.default]?object[this.$store.state.locales.default]:(t.forEach((function(t){object[t]&&(e=object[t])})),"--"===e&&this.$store.state.locales.list.forEach((function(t){object[t.url]&&(e="".concat(object[t.url]," (needs translation)"))})),e)},onCopy:function(){this.$emit("clone",this.index)},setFieldDeleted:function(){this.field.deleted=!0,this.$forceUpdate()},setFieldUndoDeleted:function(){this.field.deleted=!1,this.$forceUpdate()},setNewActiveField:function(e){var t,r;this.activeField=l(l({},e),{},{currentIndex:this.index,parent_id:null!==(t=null!==(r=this.givenParentId)&&void 0!==r?r:e.parent_id)&&void 0!==t?t:null})}}},d=(r(723),r(63)),component=Object(d.a)(c,(function(){var e=this,t=e._self._c;return t("div",{class:{"field-card":!0,isactive:e.ishovering,deleted:e.field.deleted},on:{mouseover:function(t){e.ishovering=!0},mouseleave:function(t){e.ishovering=!1}}},[t("div",{staticClass:"card-body"},[e.combination?t("div",{staticClass:"collapseble",on:{click:function(t){e.collapsed=!e.collapsed}}},[t("Icon",{class:{arrowdown:!0,"upside-down":e.collapsed},attrs:{icon:"chevron-down"}})],1):e._e(),e._v(" "),e.field.properties?t("b-row",{staticClass:"d-flex",on:{click:function(t){return t.stopPropagation(),e.setNewActiveField(e.field)}}},[t("div",{staticClass:"label-flex text-truncate",staticStyle:{"min-height":"20px"}},[e.combination?t("h3",{class:{"mb-3":!e.collapsed}},[e._v("\n          "+e._s(e.title)+"\n        ")]):t("span",[e._v(e._s(e.title))]),e._v(" "),e.field.properties.required?t("span",{staticClass:"required-star"},[e._v("*")]):e._e()]),e._v(" "),t("div",{staticClass:"type-flex"},[e._v(e._s(e.typename))])]):e._e(),e._v(" "),e.combination?t("div",[e.collapsed?e._e():t("FormbuilderFieldList",{attrs:{list:e.field.fields,givenParentId:e.guaranteedParentId}}),e._v(" "),e.field.deleted?t("div",{staticClass:"d-flex justify-content-center"},[e._v("\n        combinatie gemarkeerd voor verwijdering.\n      ")]):e._e()],1):e._e()],1),e._v(" "),t("div",{staticClass:"card-draggable-anchor"},[t("div",{staticClass:"btn d-flex align-items-center h-100",staticStyle:{cursor:"grab"}},[t("Icon",{attrs:{icon:"arrows-up-down-left-right"}})],1)]),e._v(" "),t("div",{staticClass:"card-action-list"},[e.field.deleted?e._e():t("b-button",{attrs:{variant:"primary"},on:{click:e.onCopy}},[t("Icon",{attrs:{icon:"copy"}})],1),e._v(" "),e.field.deleted?t("b-button",{attrs:{variant:"success"},on:{click:function(t){return t.stopPropagation(),e.setFieldUndoDeleted.apply(null,arguments)}}},[t("Icon",{attrs:{icon:"arrow-rotate-left"}})],1):t("b-button",{attrs:{variant:"danger"},on:{click:function(t){return t.stopPropagation(),e.setFieldDeleted.apply(null,arguments)}}},[t("Icon",{attrs:{icon:"trash"}})],1)],1)])}),[],!1,null,"198ffbe2",null);t.default=component.exports;installComponents(component,{FormbuilderFieldList:r(717).default})},732:function(e,t,r){"use strict";r.r(t);r(17),r(16),r(18),r(14),r(19);var n=r(2),o=r(38);r(13),r(10),r(91),r(114),r(43),r(33),r(50),r(98);function l(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function c(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var d={props:{formId:{type:String,required:!0}},data:function(){return{originalForm:"",multiPage:!1}},fetch:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.loadForm();case 2:case"end":return t.stop()}}),t)})))()},computed:{mobileView:{get:function(){return this.$store.state.formbuilder.mobileView},set:function(e){return this.$store.commit("formbuilder/setMobileView",e)}},formLocales:{get:function(){var e=this;return 0===this.$store.state.formbuilder.activeForm.locales.length?this.$store.state.locales.list:this.$store.state.locales.list.filter((function(t){return e.$store.state.formbuilder.activeForm.locales.includes(t.url)}))}},activeField:{get:function(){return this.$store.state.formbuilder.activeField},set:function(e){return this.$store.commit("formbuilder/setActiveField",JSON.parse(JSON.stringify(e)))}},fields:{get:function(){return this.$store.state.formbuilder.fields},set:function(e){return this.$store.commit("formbuilder/setFields",e)}},temporaryId:{get:function(){return this.$store.state.formbuilder.activeForm.temporaryId}}},beforeMount:function(){var e=this;window.addEventListener("beforeunload",this.preventNav),this.$once("hook:beforeDestroy",(function(){window.removeEventListener("beforeunload",e.preventNav)}))},methods:{loadForm:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.get("/forms/".concat(e.formId,"/fields/")).then((function(t){var r,n,o,l,c,d;e.originalForm=JSON.stringify(t.data.fields),e.fields=t.data.fields,e.multiPage=null===(r=t.data.category_properties)||void 0===r?void 0:r.multipage;var f=JSON.parse(JSON.stringify(null!==(n=null===(o=e.$store.state.locales)||void 0===o?void 0:o.list.map((function(e){return e.url})))&&void 0!==n?n:[]));e.$store.commit("formbuilder/setLocales",null!==(l=null!==(c=null===(d=t.data.locales)||void 0===d?void 0:d.split(","))&&void 0!==c?c:f)&&void 0!==l?l:[]),e.$store.commit("formbuilder/setFieldProperties",t.data.available_fields),e.setBreadcrumb(t)})).catch((function(e){alert(e)}));case 2:case"end":return t.stop()}}),t)})))()},saveForm:function(){var e=this;this.$axios.patch("/forms/".concat(this.formId,"/fields/"),{id:this.formId,fields:this.$store.state.formbuilder.fields}).then((function(t){e.fields=t.data,e.originalForm=JSON.stringify(t.data),e.$sbToast.success("Formulier opgeslagen")})).catch((function(t){e.$sbToast.error("Error loading")}))},routeLeave:function(e,t,r){(JSON.stringify(this.fields)===this.originalForm||window.confirm("Weet je zeker dat je de pagina wilt verlaten? Alle wijzigingen die je gemaakt hebt worden ongedaan gemaakt."))&&(this.originalForm=JSON.stringify(this.fields),r())},preventNav:function(e){JSON.stringify(this.fields)!==this.originalForm&&(e.preventDefault(),e.returnValue="")},addEmptyCombination:function(){for(var e={},i=0;i<this.formLocales.length;i+=1){e[this.formLocales[i].url]=""}var t={temporaryId:this.temporaryId,type:"Combination",properties:{label:e},fields:[]};this.$store.commit("formbuilder/incrementTemporaryId"),this.fields=this.fields.concat([t]),this.activeField=c(c({},t),{},{currentIndex:this.fields.length-1,parent_id:null,new:!0})},setBreadcrumb:function(e){var t;t=e.data.category?{text:e.data.category,to:"/forms/c/".concat(e.data.category_slug)}:{text:this.$t("forms.combinations"),to:"/forms/combinations"};var r=[{text:this.$t("forms.forms"),to:"/forms"},t,{text:e.data.name}];this.$store.commit("setBreadcrumb",r)}}},f=r(63),component=Object(f.a)(d,(function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"d-flex justify-content-between align-items-center mb-3"},[t("b-form-checkbox",{attrs:{name:"check-button",switch:""},model:{value:e.mobileView,callback:function(t){e.mobileView=t},expression:"mobileView"}},[e._v("\n      Toon breedte zoals op mobiel\n    ")]),e._v(" "),e.multiPage?t("b-button",{attrs:{variant:"outline-primary"},on:{click:e.addEmptyCombination}},[t("Icon",{attrs:{icon:"plus"}})],1):e._e()],1),e._v(" "),0===e.fields.length?t("div",{staticClass:"p-4 align-self-center text-center"},[e.multiPage?t("h3",[e._v("\n      Om velden te plaatsen moet je eerst een blok plaatsen met het plusje\n      rechtsboven.\n    ")]):t("h3",[e._v("Sleep hieronder een veld om te beginnen")])]):e._e(),e._v(" "),t("FormbuilderFieldList",{attrs:{list:e.fields,multiPage:e.multiPage}}),e._v(" "),t("b-navbar",{staticClass:"navbar-fixed",attrs:{toggleable:"lg",type:"dark",variant:"secondary",fixed:"bottom"}},[t("b-navbar-nav",{staticClass:"ml-auto mr-3"},[t("b-button",{attrs:{type:"light",variant:"primary"},on:{click:function(t){return e.saveForm()}}},[e._v("\n        "+e._s(e.$t("save"))+"\n      ")])],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{FormbuilderFieldList:r(717).default})}}]);